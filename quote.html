<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="512x512" href="/favicon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<title>Instant Quote | Oasis International Cleaning Services</title>
<meta name="description" content="Get an instant quote for domestic cleaning, end of tenancy cleaning, or office cleaning across London. No guesswork—clear pricing confirmed before booking.">
<link rel="canonical" href="https://www.oasisinternationalcleaningservices.com/quote.html">

<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

<link rel="stylesheet" href="styles.css">

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=AW-17779427647"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'AW-17779427647');
</script>

<style>
/* Quote Estimator Specific Styles */
.quote-section { margin-bottom: var(--space-lg); }
.quote-section-title {
  font-size: 1rem;
  font-weight: var(--font-weight-semibold);
  margin-bottom: var(--space-md);
  color: var(--text-primary);
}
.quote-grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-md); }
.quote-grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: var(--space-md); }
@media (max-width: 640px) {
  .quote-grid-2, .quote-grid-3 { grid-template-columns: 1fr; }
}
.checkbox-group { display: flex; flex-direction: column; gap: 0.5rem; }
.checkbox-label {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.9375rem;
  color: var(--text-secondary);
  cursor: pointer;
}
.checkbox-label input[type="checkbox"] {
  width: 18px;
  height: 18px;
  accent-color: var(--accent-green);
}
.form-hint {
  font-size: 0.8125rem;
  color: var(--text-secondary);
  margin-top: 0.25rem;
}
#output {
  padding: var(--space-lg);
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-muted);
  border-radius: 2px;
}
#output h2 {
  font-size: 1.5rem;
  margin-bottom: var(--space-md);
}
#output h3 {
  font-size: 1rem;
  margin: var(--space-md) 0 var(--space-sm);
  color: var(--text-primary);
}
#output ul, #output ol {
  margin: 0;
  padding-left: 1.25rem;
}
#output li {
  margin-bottom: 0.5rem;
  color: var(--text-secondary);
}
#output strong {
  color: var(--text-primary);
}
#output a {
  color: var(--accent-green);
}
.eot-fields { display: none; }
.eot-fields.visible { display: block; }
</style>
</head>
<body>
<a href="#main" class="sr-only">Skip to main content</a>

<!-- Header -->
<header class="header">
  <div class="header-inner">
    <a href="index.html" class="brand">
      <img src="assets/logo.jpeg" alt="Oasis International Cleaning Services">
    </a>
    
    <nav class="header-nav">
      <a href="index.html">Home</a>
      
      <div class="dropdown">
        <button type="button" aria-haspopup="true" aria-expanded="false">
          Services <span aria-hidden="true">▾</span>
        </button>
        <div class="dropdown-menu" role="menu">
          <a role="menuitem" href="domestic-cleaning-london.html">Residential Cleaning</a>
          <a role="menuitem" href="end-of-tenancy-cleaning-london.html">End of Tenancy Cleaning</a>
          <a role="menuitem" href="office-cleaning-london.html">Office Cleaning</a>
        </div>
      </div>
      
      <a href="quote.html" class="active">Get a Quote</a>
      <a href="contact.html">Contact</a>
    </nav>
    
    <button class="mobile-menu-btn" id="mobile-menu-btn" aria-label="Toggle menu">
      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 6h16M4 12h16M4 18h16"/></svg>
    </button>
  </div>
  
  <div class="mobile-menu" id="mobile-menu">
    <a href="index.html">Home</a>
    <a href="domestic-cleaning-london.html">Residential Cleaning</a>
    <a href="end-of-tenancy-cleaning-london.html">End of Tenancy Cleaning</a>
    <a href="office-cleaning-london.html">Office Cleaning</a>
    <a href="quote.html">Get a Quote</a>
    <a href="contact.html">Contact</a>
  </div>
</header>

<main id="main">
  
  <!-- Hero -->
  <section class="page-hero">
    <div class="container">
      <p style="font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--accent-green); margin-bottom: 1rem; font-weight: 600;">
        Instant, Fixed-Price Cleaning Quotes
      </p>
      <h1>Get Your Cleaning Quote</h1>
      <p class="sub" style="max-width: 65ch;">
        No guessing, no call-backs. Oasis International Cleaning Services uses a professional pricing system to calculate fair, transparent and consistent cleaning prices based on the real work required.
      </p>
      <p class="sub" style="font-weight: 500; color: var(--text-primary);">
        You will receive a fixed price before booking — not an estimate.
      </p>
    </div>
  </section>

  <!-- Why We Use a Quote System -->
  <section class="section" style="padding-bottom: 0;">
    <div class="container">
      <div style="max-width: 700px;">
        <h2 style="margin-bottom: var(--s3);">Why We Use a Quote System</h2>
        <p>Every home and property is different. To maintain professional standards and fairly pay our cleaners, pricing is calculated using:</p>
        <ul class="list-check" style="margin-bottom: var(--s3);">
          <li>Property size</li>
          <li>Number of rooms</li>
          <li>Bathrooms</li>
          <li>Level of build-up</li>
          <li>Frequency (for domestic cleaning)</li>
          <li>Service type (domestic, end of tenancy or office)</li>
        </ul>
        <p>This ensures:</p>
        <ul class="list-check">
          <li>You pay a fair price</li>
          <li>Our cleaners are paid properly</li>
          <li>Service quality is consistent</li>
        </ul>

        <h3 style="margin-top: var(--s4); margin-bottom: var(--s2);">Minimum Bookings</h3>
        <p>To maintain professional standards:</p>
        <ul class="list-check">
          <li><strong>Domestic & Office Cleaning:</strong> minimum 2 hours</li>
          <li><strong>End of Tenancy Cleaning:</strong> minimum team allocation applies</li>
        </ul>

        <h3 style="margin-top: var(--s4); margin-bottom: var(--s2);">VAT</h3>
        <p>Oasis International Cleaning Services is <strong>not VAT registered</strong>. The price you see is the price you pay.</p>

        <h3 style="margin-top: var(--s4); margin-bottom: var(--s2);">Service Areas</h3>
        <p>We provide cleaning services in: <strong>Kensington & Chelsea, Camden, Richmond, Kingston, Wandsworth</strong>. Quotes outside these areas may not be available.</p>
      </div>
    </div>
  </section>

  <!-- Quote Estimator -->
  <section class="section-lg" style="background-color: var(--bg-secondary);">
    <div class="container">
      <div style="max-width: 800px;">
        
        <form id="quoteForm">
          
          <!-- Service Selection -->
          <div class="quote-section">
            <div class="quote-grid-2">
              <div>
                <label class="form-label" for="postcode">Postcode / Area</label>
                <input id="postcode" name="postcode" type="text" placeholder="e.g. NW10" class="form-field">
              </div>
              <div>
                <label class="form-label" for="serviceType">Service Type</label>
                <select id="serviceType" name="serviceType" class="form-field">
                  <option value="">Select…</option>
                  <option value="EOT">End of Tenancy / Deep Clean</option>
                  <option value="DOMESTIC">Standard Domestic Cleaning</option>
                  <option value="OFFICE">Office Cleaning</option>
                </select>
              </div>
            </div>
          </div>

          <hr class="divider-gold">

          <!-- DOMESTIC / EOT BLOCK -->
          <div id="domesticBlock" style="display: none;">
            
            <div class="quote-section">
              <h3 class="quote-section-title">Property Details</h3>
              <div class="quote-grid-3">
                <div>
                  <label class="form-label" for="propertyType">Property Type</label>
                  <select id="propertyType" name="propertyType" class="form-field">
                    <option value="">Select…</option>
                    <option value="Flat">Flat</option>
                    <option value="House">House</option>
                  </select>
                </div>
                <div>
                  <label class="form-label" for="bedrooms">Bedrooms</label>
                  <input id="bedrooms" name="bedrooms" type="number" min="0" placeholder="e.g. 3" class="form-field">
                </div>
                <div>
                  <label class="form-label" for="bathrooms">Bathrooms</label>
                  <input id="bathrooms" name="bathrooms" type="number" min="0" placeholder="e.g. 2" class="form-field">
                </div>
              </div>
            </div>

            <div class="quote-section">
              <div class="quote-grid-2">
                <div>
                  <label class="form-label" for="condition">Condition</label>
                  <select id="condition" name="condition" class="form-field">
                    <option value="">Select…</option>
                    <option value="Standard">Standard maintenance</option>
                    <option value="Heavy">Heavy build-up</option>
                  </select>
                </div>
                <div>
                  <label class="form-label" for="frequency">Frequency</label>
                  <select id="frequency" name="frequency" class="form-field">
                    <option value="">Select…</option>
                    <option value="One-off">One-off</option>
                    <option value="Weekly">Weekly</option>
                    <option value="Fortnightly">Fortnightly</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="quote-section">
              <h3 class="quote-section-title">Add-ons (optional)</h3>
              <div class="quote-grid-3">
                <div class="checkbox-group">
                  <label class="checkbox-label"><input type="checkbox" id="addonFridge"> Fridge (internal)</label>
                  <label class="checkbox-label"><input type="checkbox" id="addonOven"> Oven (internal)</label>
                  <label class="checkbox-label"><input type="checkbox" id="addonWindows"> Internal windows</label>
                </div>
                <div>
                  <label class="checkbox-label"><input type="checkbox" id="addonIroning"> Ironing included</label>
                  <p class="form-hint">If large volume, we will confirm time before final quote.</p>
                </div>
                <div>
                  <label class="form-label" for="parking">Access / Parking</label>
                  <select id="parking" name="parking" class="form-field">
                    <option value="">Select…</option>
                    <option value="None">No parking / street only</option>
                    <option value="Permit">Resident permit available</option>
                    <option value="Paid">Paid parking required</option>
                    <option value="On-site">On-site parking</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="quote-section">
              <label class="form-label" for="congestion">Congestion Charge Zone</label>
              <select id="congestion" name="congestion" class="form-field" style="max-width: 300px;">
                <option value="">Select…</option>
                <option value="No">Outside congestion zone</option>
                <option value="Yes">Inside congestion zone</option>
                <option value="Unsure">Not sure</option>
              </select>
              <p class="form-hint">If inside the zone, any charge is confirmed and passed through at cost where applicable.</p>
            </div>

            <!-- EOT-specific fields -->
            <div class="eot-fields" id="eotFields">
              <hr class="divider-gold">
              <div class="quote-section">
                <h3 class="quote-section-title">End of Tenancy Details</h3>
                
                <div class="quote-grid-2" style="margin-bottom: var(--space-md);">
                  <div>
                    <label class="form-label" for="preferredDate">Preferred Date</label>
                    <input id="preferredDate" name="preferredDate" type="date" class="form-field">
                  </div>
                  <div>
                    <label class="form-label" for="arrivalWindow">Arrival Window</label>
                    <select id="arrivalWindow" name="arrivalWindow" class="form-field">
                      <option value="">Select…</option>
                      <option value="Morning (8–12)">Morning (8–12)</option>
                      <option value="Midday (12–3)">Midday (12–3)</option>
                      <option value="Afternoon (3–6)">Afternoon (3–6)</option>
                      <option value="Evening (6–9)">Evening (6–9)</option>
                      <option value="Flexible">Flexible</option>
                    </select>
                  </div>
                </div>

                <div style="margin-bottom: var(--space-md);">
                  <label class="form-label" for="deadline">Any Deadline? (e.g. check-out / inventory time)</label>
                  <input id="deadline" name="deadline" type="text" placeholder="e.g. Must finish by 3pm" class="form-field">
                </div>

                <div class="quote-grid-2" style="margin-bottom: var(--space-md);">
                  <div>
                    <label class="form-label" for="floorLevel">Floor Level</label>
                    <select id="floorLevel" name="floorLevel" class="form-field">
                      <option value="">Select…</option>
                      <option value="Ground">Ground</option>
                      <option value="1st">1st</option>
                      <option value="2nd">2nd</option>
                      <option value="3rd">3rd</option>
                      <option value="4th+">4th+</option>
                    </select>
                  </div>
                  <div>
                    <label class="form-label" for="liftAvailable">Lift Available?</label>
                    <select id="liftAvailable" name="liftAvailable" class="form-field">
                      <option value="">Select…</option>
                      <option value="Yes">Yes</option>
                      <option value="No">No</option>
                    </select>
                  </div>
                </div>

                <div class="quote-grid-2" style="margin-bottom: var(--space-md);">
                  <div>
                    <label class="form-label" for="occupancy">Property Occupancy</label>
                    <select id="occupancy" name="occupancy" class="form-field">
                      <option value="">Select…</option>
                      <option value="Vacant">Vacant (true EOT)</option>
                      <option value="Occupied">Occupied (still living there)</option>
                    </select>
                  </div>
                  <div>
                    <label class="form-label" for="carpetSteam">Carpets/Steam Cleaning Needed?</label>
                    <select id="carpetSteam" name="carpetSteam" class="form-field">
                      <option value="">Select…</option>
                      <option value="No">No</option>
                      <option value="Yes">Yes (requires confirmation)</option>
                    </select>
                  </div>
                </div>

                <div style="margin-bottom: var(--space-md);">
                  <label class="form-label">Appliances to Include</label>
                  <div class="quote-grid-2">
                    <div class="checkbox-group">
                      <label class="checkbox-label"><input type="checkbox" id="applianceOven"> Oven</label>
                      <label class="checkbox-label"><input type="checkbox" id="applianceFridge"> Fridge / Freezer</label>
                    </div>
                    <div class="checkbox-group">
                      <label class="checkbox-label"><input type="checkbox" id="applianceWasher"> Washing machine</label>
                      <label class="checkbox-label"><input type="checkbox" id="applianceDishwasher"> Dishwasher</label>
                    </div>
                  </div>
                  <p class="form-hint">If appliances are not selected, they are treated as not included.</p>
                </div>

                <div style="margin-bottom: var(--space-md);">
                  <label class="form-label" for="wasteRemoval">Waste / Rubbish Removal Expected?</label>
                  <select id="wasteRemoval" name="wasteRemoval" class="form-field" style="max-width: 300px;">
                    <option value="">Select…</option>
                    <option value="No">No (standard cleaning only)</option>
                    <option value="Yes">Yes (requires confirmation)</option>
                  </select>
                  <p class="form-hint">If yes, we will confirm scope and price before booking.</p>
                </div>

                <div class="quote-grid-2">
                  <div>
                    <label class="form-label" for="teamSize">Team Size</label>
                    <select id="teamSize" name="teamSize" class="form-field">
                      <option value="1">1 cleaner</option>
                      <option value="2" selected>2 cleaners (recommended for EOT)</option>
                    </select>
                    <p class="form-hint">Affects estimated on-site duration, not the hourly rate.</p>
                  </div>
                  <div>
                    <label class="form-label" for="ironVolume">Ironing Volume (if included)</label>
                    <select id="ironVolume" name="ironVolume" class="form-field">
                      <option value="none" selected>Not included</option>
                      <option value="light">Light (up to 1 basket)</option>
                      <option value="medium">Medium (1–2 baskets)</option>
                      <option value="heavy">Heavy (3+ baskets — requires confirmation)</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- OFFICE BLOCK -->
          <div id="officeBlock" style="display: none;">
            
            <div class="quote-section">
              <h3 class="quote-section-title">Office Details</h3>
              <div class="quote-grid-2">
                <div>
                  <label class="form-label" for="officeSize">Office Size (m² or sq ft)</label>
                  <input id="officeSize" name="officeSize" type="text" placeholder="e.g. 150 m² or 1,600 sq ft" class="form-field">
                  <p class="form-hint">If unknown, provide desks + rooms instead.</p>
                </div>
                <div>
                  <label class="form-label" for="desksRooms">OR: Desks + Rooms</label>
                  <input id="desksRooms" name="desksRooms" type="text" placeholder="e.g. 24 desks, 3 meeting rooms" class="form-field">
                </div>
              </div>
            </div>

            <div class="quote-section">
              <div class="quote-grid-3">
                <div>
                  <label class="form-label" for="officeToilets">Toilets</label>
                  <input id="officeToilets" type="number" min="0" placeholder="e.g. 2" class="form-field">
                </div>
                <div>
                  <label class="form-label" for="officeKitchens">Kitchen / Break Areas</label>
                  <input id="officeKitchens" type="number" min="0" placeholder="e.g. 1" class="form-field">
                </div>
                <div>
                  <label class="form-label" for="officeFrequency">Frequency</label>
                  <select id="officeFrequency" class="form-field">
                    <option value="">Select…</option>
                    <option value="Adhoc">Ad hoc / irregular</option>
                    <option value="Weekly">Weekly</option>
                    <option value="2x">2× per week</option>
                    <option value="Daily">Daily</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="quote-section">
              <div class="quote-grid-2">
                <div>
                  <label class="form-label" for="outOfHours">Out-of-Hours Required?</label>
                  <select id="outOfHours" class="form-field">
                    <option value="">Select…</option>
                    <option value="No">No</option>
                    <option value="Yes">Yes</option>
                  </select>
                </div>
                <div>
                  <label class="form-label" for="consumables">Consumables Included?</label>
                  <select id="consumables" class="form-field">
                    <option value="">Select…</option>
                    <option value="No">No</option>
                    <option value="Yes">Yes</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="quote-section">
              <label class="form-label" for="congestionOffice">Congestion Charge Zone</label>
              <select id="congestionOffice" name="congestionOffice" class="form-field" style="max-width: 300px;">
                <option value="">Select…</option>
                <option value="No">Outside congestion zone</option>
                <option value="Yes">Inside congestion zone</option>
                <option value="Unsure">Not sure</option>
              </select>
            </div>
          </div>

          <!-- CONTACT DETAILS -->
          <div id="contactBlock" style="display: none;">
            <hr class="divider-gold">
            <div class="quote-section">
              <h3 class="quote-section-title">Your Details</h3>
              <p class="form-hint" style="margin-bottom: var(--space-md);">We'll only use this to confirm your quote and booking.</p>
              
              <div class="quote-grid-2" style="margin-bottom: var(--space-md);">
                <div>
                  <label class="form-label" for="contactName">Full Name</label>
                  <input id="contactName" name="contactName" type="text" placeholder="e.g. Alex Johnson" class="form-field">
                </div>
                <div>
                  <label class="form-label" for="contactPhone">Mobile Number</label>
                  <input id="contactPhone" name="contactPhone" type="tel" placeholder="e.g. 07…" class="form-field">
                </div>
              </div>
              
              <div>
                <label class="form-label" for="contactEmail">Email Address</label>
                <input id="contactEmail" name="contactEmail" type="email" placeholder="e.g. name@email.com" class="form-field" style="max-width: 400px;">
              </div>
            </div>
            
            <!-- Honeypot -->
            <input type="text" id="botField" name="company" style="display: none;" tabindex="-1" autocomplete="off">
          </div>

          <div style="margin-top: var(--space-lg);">
            <button type="submit" class="btn-primary" style="width: 100%; max-width: 300px;">Generate Quote</button>
            <p class="form-hint" style="margin-top: var(--space-sm);">
              Note: If key information is missing or scope requires confirmation, we'll request it before issuing a final price.
            </p>
          </div>
        </form>

        <div id="output" style="margin-top: var(--space-xl); display: none;"></div>

      </div>
    </div>
  </section>

  <!-- Alternative Contact -->
  <section class="section" style="background-color: var(--bg-primary); border-top: 1px solid var(--border-muted);">
    <div class="container text-center">
      <div style="max-width: 560px; margin: 0 auto;">
        <h2 style="margin-bottom: var(--space-sm);">Need Help?</h2>
        <p style="margin-bottom: var(--space-lg); margin-left: auto; margin-right: auto;">
          If you are unsure which service to choose or have special requirements, speak to our team.
        </p>
        <div style="display: flex; flex-wrap: wrap; gap: 1rem; justify-content: center;">
          <a href="tel:02037508878" class="btn-primary">Speak to a Cleaning Advisor</a>
          <a href="https://wa.me/447947716355" class="btn-secondary">WhatsApp</a>
        </div>
      </div>
    </div>
  </section>

</main>

<!-- Footer -->
<footer class="footer">
  <div class="footer-inner">
    <div class="footer-grid">
      <div>
        <img src="assets/logo.jpeg" alt="Oasis International Cleaning Services" class="footer-logo">
        <p style="font-size: 0.9375rem; margin-top: 1rem; max-width: 280px;">
          Professional Cleaning Services Across London
        </p>
      </div>
      
      <div>
        <h4>Services</h4>
        <ul class="footer-links">
          <li><a href="domestic-cleaning-london.html">Residential Cleaning</a></li>
          <li><a href="end-of-tenancy-cleaning-london.html">End of Tenancy</a></li>
          <li><a href="office-cleaning-london.html">Office Cleaning</a></li>
        </ul>
      </div>
      
      <div>
        <h4>Company</h4>
        <ul class="footer-links">
          <li><a href="contact.html">Contact</a></li>
          <li><a href="privacy-policy.html">Privacy Policy</a></li>
          <li><a href="terms.html">Terms of Service</a></li>
        </ul>
      </div>
      
      <div>
        <h4>Contact</h4>
        <ul class="footer-links">
          <li><a href="tel:+442037508878">020 3750 8878</a></li>
          <li><a href="https://wa.me/447947716355">WhatsApp: 07947 716355</a></li>
          <li><a href="mailto:info@oasisinternationalcleaningservices.com">Email</a></li>
        </ul>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>&copy; 2025 Oasis International Cleaning Services Ltd. All rights reserved.</p>
      <p>Company No. 16660274 | 15A Unimix House, Abbey Road, London, NW10 7TR</p>
      <p>Fully insured and GDPR compliant. Professional cleaning services across London boroughs.</p>
    </div>
    
    <div style="text-align: center; padding: var(--space-md) 0;">
      <a href='https://www.bark.com/en/gb/company/oasis-international-cleaning-services/3Oomla/' target='_blank' class='bark-widget' data-type='pro' data-id='3Oomla' data-image='medium-navy' data-version='3.0'>Oasis International Cleaning Services</a>
    </div>
    <script type='text/javascript' src='https://www.bark.com/assets/js/frontend-v2/widgets-v2.23c86c9202e9e0e24d4e02bdac97071f.v2.js' defer></script>
  </div>
</footer>

<script>
// Mobile menu toggle
document.getElementById('mobile-menu-btn').addEventListener('click', function() {
  document.getElementById('mobile-menu').classList.toggle('open');
});

// =============================
// QUOTE ESTIMATOR LOGIC
// =============================
const RATE_EOT = 50; // fixed EOT rate

function gbp(n) { return "£" + Number(n).toFixed(2); }

function renderOutput(html) {
  const out = document.getElementById("output");
  out.style.display = "block";
  out.innerHTML = html;
  out.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

// Choose ONE exact domestic/office hourly rate (no ranges)
function pickHourlyRate({ serviceType, condition, frequency, hasPets, difficultAccess, premiumExpectations, firstTime }) {
  if (serviceType === "OFFICE") {
    if (condition === "Heavy" || difficultAccess || premiumExpectations) return 40;
    if (firstTime) return 35;
    return 32;
  }
  // DOMESTIC
  if (condition === "Heavy" || difficultAccess || premiumExpectations) return 40;
  if (hasPets) return 35;
  if (firstTime || frequency === "One-off") return 32;
  if (frequency === "Weekly" || frequency === "Fortnightly") return 28;
  return 32;
}

// CAPPED Domestic/EOT estimator
function estimateDomesticHoursCapped({
  bedrooms, bathrooms, serviceType, condition,
  addonFridge, addonOven, addonWindows,
  ironingIncluded, ironVolume
}) {
  if (ironingIncluded && ironVolume === "heavy") return null;

  let base;
  if (serviceType === "EOT") {
    base = 3.0 + (bedrooms * 0.7) + (bathrooms * 0.7);
  } else {
    base = 2.0 + (bedrooms * 0.5) + (bathrooms * 0.5);
  }

  if (condition === "Heavy") base += 1.5;

  let addons = 0;
  if (addonFridge) addons += 0.5;
  if (addonOven) addons += 0.75;
  if (addonWindows) addons += 0.75;

  if (ironingIncluded) {
    if (ironVolume === "light") addons += 0.5;
    if (ironVolume === "medium") addons += 0.75;
  }

  if (serviceType === "EOT") {
    const addonCap = (condition === "Heavy") ? 1.5 : 1.0;
    addons = Math.min(addons, addonCap);
  }

  let total = base + addons;

  if (serviceType === "EOT") {
    let ceiling;
    if (bedrooms <= 1) ceiling = 5.0;
    else if (bedrooms === 2) ceiling = 6.0;
    else if (bedrooms === 3) ceiling = 7.0;
    else if (bedrooms === 4) ceiling = 8.0;
    else ceiling = 9.0;

    if (condition === "Heavy") ceiling += 1.0;
    total = Math.min(total, ceiling);
  }

  total = Math.max(2, total);
  return Math.round(total * 2) / 2;
}

// Toggle blocks by service type
const serviceTypeEl = document.getElementById("serviceType");
const domesticBlock = document.getElementById("domesticBlock");
const officeBlock = document.getElementById("officeBlock");
const contactBlock = document.getElementById("contactBlock");
const eotFields = document.getElementById("eotFields");

serviceTypeEl.addEventListener("change", () => {
  const v = serviceTypeEl.value;
  domesticBlock.style.display = (v === "EOT" || v === "DOMESTIC") ? "block" : "none";
  officeBlock.style.display = (v === "OFFICE") ? "block" : "none";
  contactBlock.style.display = v ? "block" : "none";
  
  // Show EOT-specific fields
  if (v === "EOT") {
    eotFields.classList.add("visible");
  } else {
    eotFields.classList.remove("visible");
  }
});

// Send lead to backend
async function sendLeadToServer(payload) {
  try {
    const res = await fetch("/api/quote-lead", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload),
    });
    if (!res.ok) {
      console.error("Lead capture failed:", await res.text());
      return false;
    }
    const data = await res.json();
    console.log("Lead saved:", data);
    return true;
  } catch (e) {
    console.error("Lead capture error:", e);
    return false;
  }
}

document.getElementById("quoteForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  const serviceType = serviceTypeEl.value;
  const postcode = (document.getElementById("postcode").value || "").trim();

  // Contact fields
  const contactName = document.getElementById("contactName")?.value.trim() || "";
  const contactPhone = document.getElementById("contactPhone")?.value.trim() || "";
  const contactEmail = document.getElementById("contactEmail")?.value.trim() || "";
  const botField = document.getElementById("botField")?.value || "";

  if (!serviceType) {
    renderOutput(`<p style="margin:0;"><strong>Missing:</strong> Please select a service type.</p>`);
    return;
  }

  // DOMESTIC / EOT
  if (serviceType === "EOT" || serviceType === "DOMESTIC") {
    const propertyType = document.getElementById("propertyType").value;
    const bedroomsRaw = document.getElementById("bedrooms").value;
    const bathroomsRaw = document.getElementById("bathrooms").value;
    const bedrooms = Number(bedroomsRaw);
    const bathrooms = Number(bathroomsRaw);
    const condition = document.getElementById("condition").value;
    const frequency = document.getElementById("frequency").value;
    const parking = document.getElementById("parking").value;
    const congestion = document.getElementById("congestion").value;

    const addonFridgeCheckbox = document.getElementById("addonFridge").checked;
    const addonOvenCheckbox = document.getElementById("addonOven").checked;
    const addonWindows = document.getElementById("addonWindows").checked;
    const ironingIncluded = document.getElementById("addonIroning").checked;

    const preferredDate = document.getElementById("preferredDate")?.value || "";
    const arrivalWindow = document.getElementById("arrivalWindow")?.value || "";
    const deadline = (document.getElementById("deadline")?.value || "").trim();
    const floorLevel = document.getElementById("floorLevel")?.value || "";
    const liftAvailable = document.getElementById("liftAvailable")?.value || "";
    const occupancy = document.getElementById("occupancy")?.value || "";
    const carpetSteam = document.getElementById("carpetSteam")?.value || "";
    const wasteRemoval = document.getElementById("wasteRemoval")?.value || "";

    const applianceOven = document.getElementById("applianceOven")?.checked || false;
    const applianceFridge = document.getElementById("applianceFridge")?.checked || false;
    const applianceWasher = document.getElementById("applianceWasher")?.checked || false;
    const applianceDishwasher = document.getElementById("applianceDishwasher")?.checked || false;

    const teamSize = Number(document.getElementById("teamSize")?.value || "1");
    const ironVolume = document.getElementById("ironVolume")?.value || "none";

    // No-guess missing checklist
    const missing = [];
    if (!postcode) missing.push("Postcode/area");
    if (!propertyType) missing.push("Property type (flat/house)");
    if (bedroomsRaw === "") missing.push("Bedrooms");
    if (bathroomsRaw === "") missing.push("Bathrooms");
    if (!condition) missing.push("Condition (standard maintenance vs heavy build-up)");
    if (!frequency) missing.push("Frequency (one-off/weekly/fortnightly)");
    if (!parking) missing.push("Access/parking");

    if (serviceType === "EOT") {
      if (!preferredDate) missing.push("Preferred date");
      if (!arrivalWindow) missing.push("Arrival window");
      if (!floorLevel) missing.push("Floor level");
      if (!liftAvailable) missing.push("Lift available (yes/no)");
      if (!occupancy) missing.push("Property occupancy (vacant/occupied)");
      if (!carpetSteam) missing.push("Carpets/steam cleaning needed? (yes/no)");
      if (!wasteRemoval) missing.push("Waste/rubbish removal expected? (yes/no)");
      if (!congestion || congestion === "Unsure") missing.push("Congestion charge zone (inside/outside)");
    }

    if (missing.length) {
      renderOutput(`
        <h2>We need a few details before we can quote</h2>
        <ul>${missing.map(m => `<li>${m}</li>`).join("")}</ul>
        <p style="margin:10px 0 0; color:var(--text-secondary);">
          We never guess. Once confirmed, we'll generate an exact price with full calculations.
        </p>
      `);
      return;
    }

    // Scope gates
    if (serviceType === "EOT" && carpetSteam === "Yes") {
      renderOutput(`
        <h2>Carpet/steam cleaning needs a quick confirmation</h2>
        <p>You selected <strong>carpets/steam cleaning required</strong>. To avoid guessing, we need the number of carpeted rooms and carpet type before issuing a final price.</p>
        <p style="margin-top: var(--space-md);">
          <a href="tel:+442037508878" class="btn-primary">Call Us: 020 3750 8878</a>
        </p>
      `);
      return;
    }

    if (serviceType === "EOT" && wasteRemoval === "Yes") {
      renderOutput(`
        <h2>Waste removal needs a quick confirmation</h2>
        <p>You selected <strong>waste/rubbish removal expected</strong>. Please confirm approximate volume so we can price it correctly.</p>
        <p style="margin-top: var(--space-md);">
          <a href="tel:+442037508878" class="btn-primary">Call Us: 020 3750 8878</a>
        </p>
      `);
      return;
    }

    const addonFridge = addonFridgeCheckbox || applianceFridge;
    const addonOven = addonOvenCheckbox || applianceOven;

    const difficultAccess = (parking === "None" || parking === "Paid");
    let rate;
    if (serviceType === "EOT") {
      rate = RATE_EOT;
    } else {
      rate = pickHourlyRate({
        serviceType: "DOMESTIC",
        condition,
        frequency,
        hasPets: false,
        difficultAccess,
        premiumExpectations: false,
        firstTime: (frequency === "One-off")
      });
    }

    const hours = estimateDomesticHoursCapped({
      bedrooms, bathrooms, serviceType, condition,
      addonFridge, addonOven, addonWindows,
      ironingIncluded, ironVolume
    });

    if (hours === null) {
      renderOutput(`
        <h2>We need one quick confirmation</h2>
        <p>You selected <strong>heavy ironing (3+ baskets)</strong>. To avoid guessing, please confirm approximate quantity.</p>
        <p style="margin-top: var(--space-md);">
          <a href="tel:+442037508878" class="btn-primary">Call Us: 020 3750 8878</a>
        </p>
      `);
      return;
    }

    const clientTotal = hours * rate;
    const onsiteDuration = hours / Math.max(1, teamSize);
    const serviceLabel = (serviceType === "EOT") ? "End of Tenancy / Deep Clean" : "Standard Domestic Cleaning";

    // Contact validation
    const contactMissing = [];
    if (!contactName) contactMissing.push("Full name");
    if (!contactPhone && !contactEmail) contactMissing.push("Mobile number or email");

    if (contactMissing.length) {
      renderOutput(`
        <h2>We just need your contact details</h2>
        <ul>${contactMissing.map(m => `<li>${m}</li>`).join("")}</ul>
        <p style="margin:10px 0 0; color:var(--text-secondary);">
          This allows us to confirm availability and secure your booking.
        </p>
        <h3>Your Quote Preview</h3>
        <p><strong>${serviceLabel}</strong> | ${hours} hours | <strong>${gbp(clientTotal)}</strong></p>
      `);
      return;
    }

    // Appliances list
    const appliancesIncluded = [
      applianceOven && "Oven",
      applianceFridge && "Fridge/Freezer",
      applianceWasher && "Washing machine",
      applianceDishwasher && "Dishwasher"
    ].filter(Boolean);

    const addOnsDisplay = [
      addonFridge && "Fridge (internal)",
      addonOven && "Oven (internal)",
      addonWindows && "Internal windows",
      ironingIncluded && (ironVolume !== "none" ? `Ironing (${ironVolume})` : "Ironing")
    ].filter(Boolean);

    // Build payload and send to server
    const payload = {
      serviceType,
      postcode,
      contact: {
        name: contactName,
        phone: contactPhone,
        email: contactEmail
      },
      botField,
      property: {
        type: propertyType,
        bedrooms,
        bathrooms,
        condition,
        frequency
      },
      quote: {
        hours,
        teamSize,
        onsiteDuration,
        rate,
        clientTotal
      },
      addOns: addOnsDisplay,
      eotDetails: serviceType === "EOT" ? {
        preferredDate,
        arrivalWindow,
        deadline,
        floorLevel,
        liftAvailable,
        occupancy,
        carpetSteam,
        wasteRemoval,
        appliances: appliancesIncluded
      } : null
    };

    // Send to backend (non-blocking)
    sendLeadToServer(payload);

    renderOutput(`
      <h2>Your Quote</h2>
      <p style="margin-bottom: var(--space-md);">
        <strong>${serviceLabel}</strong> in <strong>${postcode}</strong>, ${propertyType.toLowerCase()},
        ${bedrooms} bed / ${bathrooms} bath, ${frequency.toLowerCase()},
        condition: ${condition === "Heavy" ? "heavy build-up" : "standard maintenance"}.
      </p>

      <h3>Quote Summary</h3>
      <ul>
        <li>Total job-hours: <strong>${hours}</strong></li>
        <li>Team size: <strong>${teamSize}</strong> cleaner(s)</li>
        <li>Estimated on-site duration: <strong>${onsiteDuration.toFixed(1)} hours</strong></li>
        <li>Rate: <strong>${gbp(rate)}/hour</strong></li>
        <li style="font-size: 1.125rem; margin-top: 0.5rem;"><strong>Total: ${gbp(clientTotal)}</strong></li>
      </ul>

      ${serviceType === "EOT" ? `
      <h3>Booking Details</h3>
      <ul>
        <li>Date: ${preferredDate} (${arrivalWindow})</li>
        <li>Floor: ${floorLevel} | Lift: ${liftAvailable}</li>
        <li>Add-ons: ${addOnsDisplay.length ? addOnsDisplay.join(", ") : "None"}</li>
        <li>Appliances: ${appliancesIncluded.length ? appliancesIncluded.join(", ") : "None selected"}</li>
      </ul>
      ` : `
      <h3>Details</h3>
      <ul>
        <li>Add-ons: ${addOnsDisplay.length ? addOnsDisplay.join(", ") : "None"}</li>
        <li>Parking/access: ${parking}</li>
      </ul>
      `}

      <h3>Next Step</h3>
      <p>We've received your details (<strong>${contactName}</strong>). We'll be in touch within 24 hours to confirm your booking.</p>
      <p style="margin-top: var(--space-md);">
        <a href="tel:+442037508878" class="btn-primary">Call Us: 020 3750 8878</a>
        <a href="https://wa.me/447947716355" class="btn-secondary" style="margin-left: 1rem;">WhatsApp</a>
      </p>

      <p style="margin-top: var(--space-md); font-size: 0.875rem; color: var(--text-secondary);">
        Important: If build-up is heavier than described or access restrictions apply, time may be adjusted prior to confirmation.
      </p>
    `);
    return;
  }

  // OFFICE
  if (serviceType === "OFFICE") {
    const officeSize = (document.getElementById("officeSize").value || "").trim();
    const desksRooms = (document.getElementById("desksRooms").value || "").trim();
    const officeToilets = document.getElementById("officeToilets").value;
    const officeKitchens = document.getElementById("officeKitchens").value;
    const officeFrequency = document.getElementById("officeFrequency").value;
    const outOfHours = document.getElementById("outOfHours").value;
    const consumables = document.getElementById("consumables").value;
    const congestionOffice = document.getElementById("congestionOffice").value;

    const missing = [];
    if (!postcode) missing.push("Postcode/area");
    if (!officeSize && !desksRooms) missing.push("Approx size (m²/sq ft) OR desks + rooms");
    if (officeToilets === "" || officeToilets === null) missing.push("Toilets count");
    if (officeKitchens === "" || officeKitchens === null) missing.push("Kitchen/break areas count");
    if (!officeFrequency) missing.push("Frequency");
    if (!outOfHours) missing.push("Out-of-hours requirement (yes/no)");
    if (!congestionOffice || congestionOffice === "Unsure") missing.push("Congestion charge zone (inside/outside)");

    if (missing.length) {
      renderOutput(`
        <h2>We need a few details before we can quote</h2>
        <ul>${missing.map(m => `<li>${m}</li>`).join("")}</ul>
        <p style="margin:10px 0 0; color:var(--text-secondary);">
          If sizing is unknown, we recommend a site visit or video walkthrough so we can provide an exact price.
        </p>
      `);
      return;
    }

    // Contact validation
    const contactMissing = [];
    if (!contactName) contactMissing.push("Full name");
    if (!contactPhone && !contactEmail) contactMissing.push("Mobile number or email");

    if (contactMissing.length) {
      renderOutput(`
        <h2>We just need your contact details</h2>
        <ul>${contactMissing.map(m => `<li>${m}</li>`).join("")}</ul>
        <p style="margin:10px 0 0; color:var(--text-secondary);">
          This allows us to arrange a site survey and provide an accurate quote.
        </p>
      `);
      return;
    }

    // Build payload
    const payload = {
      serviceType,
      postcode,
      contact: {
        name: contactName,
        phone: contactPhone,
        email: contactEmail
      },
      botField,
      office: {
        size: officeSize,
        desksRooms,
        toilets: officeToilets,
        kitchens: officeKitchens,
        frequency: officeFrequency,
        outOfHours,
        consumables,
        congestionZone: congestionOffice
      }
    };

    sendLeadToServer(payload);

    renderOutput(`
      <h2>Next Step: Site Survey</h2>
      <p>Office cleaning hours must be confirmed to avoid guessing. We'll provide an exact hourly rate or fixed monthly price after a brief walkthrough.</p>

      <h3>Details Captured</h3>
      <ul>
        <li>Location: ${postcode}</li>
        <li>Size: ${officeSize || "—"}</li>
        <li>Desks/rooms: ${desksRooms || "—"}</li>
        <li>Toilets: ${officeToilets}</li>
        <li>Kitchens/break areas: ${officeKitchens}</li>
        <li>Frequency: ${officeFrequency}</li>
        <li>Out-of-hours: ${outOfHours}</li>
        <li>Consumables: ${consumables || "Not specified"}</li>
      </ul>

      <p style="margin-top: var(--space-md);">We've received your details (<strong>${contactName}</strong>). We'll be in touch within 24 hours to arrange a site survey.</p>
      
      <p style="margin-top: var(--space-md);">
        <a href="tel:+442037508878" class="btn-primary">Call Us: 020 3750 8878</a>
        <a href="https://wa.me/447947716355" class="btn-secondary" style="margin-left: 1rem;">WhatsApp</a>
      </p>
    `);
    return;
  }
});
</script>
</body>
</html>
